<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MyInterviewBot</title>

    <!-- Favicon -->
    <link rel="icon" href="img/myInterviewBot.ico">

    <!-- Bootstrap CSS -->
    <link href="vendor/bootstrap-5.3.8-dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons CSS -->
    <link rel="stylesheet" href="vendor/bootstrap-icons-1.13.1/bootstrap-icons.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="bg-light">

<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
        <a class="navbar-brand d-flex align-items-center" href="#">
            <img src="img/myInterviewBot.ico" alt="Logo" width="30" height="30" class="rounded-circle me-2">
            MyInterviewBot
        </a>
        <div class="collapse navbar-collapse">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item">
                    <a class="nav-link active" href="#" data-page="home">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-page="myInterviews">My Interviews</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-page="settings">Settings</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Flex container for sidebar + main -->
<div class="d-flex m-0 p-0">
    <!-- Left Panel -->
    <aside class="bg-light p-3 border-end" style="width: 250px; min-height: 100vh;">
        <h5>Interview Types</h5>
        <ul class="list-group">
            <li id="behavioral" class="list-group-item active">Behavioral</li>
            <li id="resume" class="list-group-item">Resume-based</li>
        </ul>
    </aside>

    <!-- Pages Container -->
    <main id="content" class="container-fluid mt-4">

        <div id = "slowSystem" class="alert alert-danger hidden" role="alert">
            ⚠️ System performance appears insufficient for local AI inference. Consider using a smaller model or switching to a faster system.
        </div>

        <!-- Home Page -->
        <div id="homePage" class="page">
            <!-- Home content -->
            <fieldset class="container-fluid mt-4 text-center">
                <!-- Title -->
                <div class="d-flex justify-content-center align-items-center mb-4">
                    <img id="interviewLogo" src="img/interview/behavioral.png" alt="MyInterviewBot Logo"
                         class="rounded-circle me-3 logo">
                    <h1 id="interviewTitle" class="mb-0">Behavioral Interview</h1>
                </div>

                <!-- Behavioral section -->
                <div id="behavioralSection">
                    <!-- Profession -->
                    <div class="mb-3 d-flex justify-content-between align-items-center">
                        <label for="inputProfession" class="form-label mb-0">Profession:</label>
                    </div>
                    <input type="text" class="form-control" id="inputProfession" placeholder="e.g. Software Engineer">
                    <br>

                    <!-- Question -->
                    <div class="mb-3 d-flex justify-content-between align-items-center">
                        <label for="inputQuestion" class="form-label mb-0">Question:</label>
                        <button id="commonQuestionsBtn" type="button" class="btn btn-outline-info btn-sm"
                                data-bs-toggle="modal"
                                data-bs-target="#commonQuestionsModal">
                            <i class="bi bi-info-circle"></i> Common Questions
                        </button>
                    </div>
                    <textarea class="form-control" id="inputQuestion" rows="3"
                              placeholder="e.g. Tell me about a time you faced a challenge at work."></textarea>

                    <!-- Button section -->
                    <div id="buttonsSection" class="input-group mb-3">
                        <button id="generateQuestionBtn"
                                class="btn btn-primary mb-3 d-flex align-items-center justify-content-center"
                                title="AI generates a Question">
                            Generate Question&nbsp;
                            <img src="img/button/ai-stars.png" alt="AI Icon"
                                 style="width: 20px; height: 20px; margin-right: 8px;">
                        </button>
                        <button type="button" class="btn btn-info mb-3 d-flex align-items-center justify-content-center"
                                data-bs-toggle="modal" data-bs-target="#infoModal">Info
                        </button>
                        <button id="resetBtnTop"
                                class="btn btn-warning mb-3 d-flex align-items-center justify-content-center"
                                title="Reset the question">
                            Reset
                        </button>
                        <button id="readyBtn"
                                class="btn btn-success mb-3 d-flex align-items-center justify-content-center"
                                title="Click me when you are ready to answer the question">
                            Ready!
                        </button>
                    </div>
                </div>

                <!-- Resume section -->
                <fieldset id="resumeSection" class="border rounded p-3 mb-4 hidden">
                    <legend class="float-none w-auto px-3 text-primary fw-semibold">Resume Section</legend>

                    <div class="mb-3">
                        <label for="resumeInput" class="form-label">Upload your resume (PDF, DOCX):</label>
                        <input class="form-control" type="file" id="resumeInput" accept=".pdf,.doc,.docx">
                    </div>

                    <button id="uploadResumeBtn" class="btn btn-primary">
                        Upload Resume
                    </button>

                    <div id="uploadFeedback" class="mt-2"></div>
                </fieldset>

                <!-- Loading GIF -->
                <div id="loading" class="mb-4 text-center hidden">
                    <img src="img/loading.gif" alt="Loading..." style="width: 50px; height: 50px;">
                </div>

                <!-- Recording & Playback section -->
                <fieldset id="recordingPlaybackContainer" class="border rounded p-3 mb-4 position-relative hidden">
                    <legend class="float-none w-auto px-3 text-primary fw-semibold">Recording section</legend>
                    <div id="recordingSection" class="mb-4">
                        <div id="videoContainer" class="position-relative mb-2" style="max-height: 300px;">
                            <!-- Placeholder image -->
                            <img id="videoPlaceholder" src="img/recording/camera-loading.gif"
                                 class="w-100 border rounded"
                                 alt="loading" style="max-height: 300px; max-width: 400px; object-fit: cover;">

                            <video id="video" autoplay muted class="border rounded w-100 video-layer"></video>

                            <!-- Recording overlay -->
                            <div id="recordingOverlay"
                                 class="position-absolute top-0 end-0 m-2 px-2 py-1 rounded d-flex align-items-center gap-2 bg-dark bg-opacity-75 text-white overlay-layer">
                                <span id="recordingTimer" class="hidden fw-bold small">02:30</span>
                                <span id="recordingIndicator" class="recording-indicator hidden"></span>
                            </div>
                        </div>
                        <!-- Record button -->
                        <label id="recordLabel"></label>
                        <button id="recordBtn" class="btn btn-light">
                            <img id="recordBtnImg" src="img/button/record.png" alt="Record"
                                 style="width: 40px; height: 40px;">
                        </button>
                    </div>

                    <!-- Playback Section -->
                    <div id="playbackSection" class="mb-4 border hidden">
                        <h5>Preview Recorded Video</h5>
                        <video id="playback" controls class="border rounded w-100" style="max-height: 300px;"></video>
                    </div>

                    <!-- Generate feedback section -->
                    <div id="generateFeedbackSection" class="mb-4 hidden">
                        <button id="generateFeedbackBtn"
                                class="btn btn-primary mb-3 d-flex align-items-center justify-content-center">
                            Generate Feedback&nbsp;
                            <img src="img/button/ai-stars.png" alt="AI Icon"
                                 style="width: 20px; height: 20px; margin-right: 8px;">
                        </button>
                    </div>
                </fieldset>

                <!-- Loading Feedback GIF -->
                <div id="loadingFeedback" class="mb-4 text-center hidden">
                    <img src="img/loading.gif" alt="Loading..." style="width: 50px; height: 50px;">
                </div>

                <!-- Transcript & Feedback section -->
                <fieldset id="transcriptFeedbackContainer" class="border rounded p-3 mb-4 position-relative hidden">
                    <legend class="float-none w-auto px-3 text-primary fw-semibold">Feedback section</legend>

                    <!-- Transcript section -->
                    <div id="transcriptSection" class="mb-4">
                        <h5>Transcript</h5>
                        <div id="transcript" class="form-control bg-light p-2" readonly
                             style="white-space: pre-wrap;"></div>
                    </div>

                    <!-- Feedback section -->
                    <div id="feedbackSection" class="mb-4 position-relative">
                        <h5>Feedback</h5>
                        <div id="feedback" class="form-control bg-light p-2" readonly
                             style="white-space: pre-wrap;"></div>
                    </div>

                    <!-- Evaluation section -->
                    <div id="evaluation-result"></div>
                </fieldset>

                <!-- Reset section -->
                <div id="resetSection" class="mb-4 hidden">
                    <button id="resetBtnBottom"
                            class="btn btn-warning mb-3 d-flex align-items-center justify-content-center">
                        Reset
                    </button>
                </div>
            </fieldset>
        </div>

        <!-- My Interviews Page -->
        <div id="myInterviewsPage" class="page hidden">
            <h2 class="mb-4">My Interviews</h2>

            <!-- Score Summary -->
            <div id="scoreSummary" class="mb-4 text-center"></div>

            <!-- Pagination Controls -->
            <nav>
                <ul id="paginationTop" class="pagination justify-content-center mt-3"></ul>
            </nav>

            <!-- My Interviews -->
            <div id="interviewsList"></div>

            <!-- Pagination Controls -->
            <nav>
                <ul id="paginationBottom" class="pagination justify-content-center mt-3"></ul>
            </nav>

            <!-- Loading GIF -->
            <div id="historyLoading" class="mb-4 text-center hidden">
                <img src="img/loading.gif" alt="Loading..." style="width: 50px; height: 50px;">
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settingsPage" class="page hidden">
            <div class="settings-page container-fluid mt-5">
                <h2 class="text-center mb-4">Settings</h2>

                <!-- All Settings -->
                <div id="settingsContainer" class="mb-4 text-center"></div>

                <!-- Clear all interviews -->
                <div class="card shadow-sm mx-auto" style="max-width: 500px;">
                    <div class="card-body text-center">
                        <h5 class="card-title text-danger mb-3">Danger Zone</h5>
                        <p class="card-text">
                            This action will permanently delete all your saved interviews and recordings.
                        </p>
                        <button id="clearInterviewsBtn" class="btn btn-danger">
                            Clear All My Interviews
                        </button>

                        <!-- Feedback message -->
                        <div id="clearMessage" class="mt-3" style="display: none;">
                            <div class="alert" role="alert"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<!-- Modals -->
<!-- Info -->
<div class="modal fade" id="infoModal" tabindex="-1" aria-labelledby="infoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="infoModalLabel">Info</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Enter a <strong>profession</strong> to get a question related to that field. If you leave it blank, the
                default will be
                Software Engineer.
                <br><br>
                Click <strong>“Generate Question”</strong> to receive a question based on your profession, or enter your
                own custom question. If you leave it blank, a question will be generated automatically.
                <br><br>
                Click <strong>“Ready!”</strong> when you are ready to answer the question.
                <br><br>
                Click <strong>“Reset”</strong> to clear the question. The profession field must be cleared manually.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Got it!</button>
            </div>
        </div>
    </div>
</div>
<!-- Questions -->
<div class="modal fade" id="commonQuestionsModal" tabindex="-1" aria-labelledby="commonQuestionsLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="commonQuestionsLabel">Common Behavioral Interview Questions</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p class="text-muted small mb-0">Select a question to add it</p>
                <ul class="list-group">
                    <li class="list-group-item">1. Tell me about a time you faced a challenge at work.</li>
                    <li class="list-group-item">2. Describe a situation where you had to work under pressure.</li>
                    <li class="list-group-item">3. Give an example of a time you showed leadership.</li>
                    <li class="list-group-item">4. Tell me about a mistake you made and what you learned from it.</li>
                    <li class="list-group-item">5. Describe a time you had a conflict with a coworker and how you
                        resolved it.
                    </li>
                    <li class="list-group-item">6. Give an example of when you went above and beyond your
                        responsibilities.
                    </li>
                    <li class="list-group-item">7. Tell me about a time you had to learn something quickly.</li>
                </ul>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- JS modules -->
<script type="module" src="js/router.js"></script>
<script type="module" src="js/main.js"></script>
<script type="module" src="js/settings.js"></script>
<script src="vendor/bootstrap-5.3.8-dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
